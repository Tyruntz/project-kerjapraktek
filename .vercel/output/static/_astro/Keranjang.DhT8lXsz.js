import{j as e}from"./jsx-runtime.D5qyYPMi.js";import{r as n}from"./index.CZlPm10g.js";import{u,r as v,c as k,i as h}from"./cartStore.D-GKsDpz.js";/* empty css                       */const E=()=>{const[x,p]=n.useState(0);n.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("meja");t&&(p(Number(t)),localStorage.getItem("reloaded")?localStorage.removeItem("reloaded"):(localStorage.setItem("reloaded","true"),window.location.reload()))},[]);const s=u(k),f=u(h),[S,i]=n.useState(1);function j(){h.set(!f),document.querySelector(".cart").classList.toggle("active")}const d=s.reduce((t,l)=>t+l.price*l.quantity,0),[r,g]=n.useState(null),[m,y]=n.useState(!1);n.useEffect(()=>{r&&window.snap.pay(r,{onSuccess:function(t){console.log("Payment Success:",t),alert("Pembayaran Berhasil!"),y(!0)},onPending:function(t){console.log("Payment Pending:",t),alert("Pembayaran Sedang Diproses...")},onError:function(t){console.error("Payment Error:",t),alert("Pembayaran Gagal. Silakan coba lagi.")},onClose:function(){console.log("Payment popup closed"),alert("Pembayaran dibatalkan.")}})},[r]),n.useEffect(()=>{m&&(alert("Berhasil melakukan checkout"),window.location.reload())},[m]);const[a,o]=n.useState({nama:"",nohp:"",email:""});return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"flex px-5 font-bold hover:text-blue-400",onClick:j,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-white",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})}),e.jsx("span",{hidden:!s.length,className:"bg-red-600 text-xs text-white rounded-full px-1 fixed right-5 top-2",children:s.length?s.length:""})]}),e.jsxs("div",{className:"cart w-full lg:w-[35rem] absolute right-[-100%] bg-white top-full",children:[e.jsx("header",{children:e.jsx("div",{className:"head grid place-content-center font-semibold uppercase",children:e.jsx("h1",{children:"Keranjang"})})}),e.jsx("main",{children:s.map(t=>e.jsxs("div",{className:"flex h-[80px] py-1 rounded-md shadow-xl bg-white",children:[e.jsx("div",{className:"flex items-center px-1",children:e.jsx("img",{src:t.imgurl,alt:"",className:"h-[70px] w-[70px] rounded-md object-cover",srcSet:""})}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("table",{className:"h-full w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"text-left",children:t.name}),e.jsx("th",{className:"text-right",children:t.price})]}),e.jsxs("tr",{className:"",children:[e.jsxs("td",{className:"px-2 text-xs",children:[e.jsx("button",{onClick:()=>{t.quantity>1&&(t.quantity-=1,i(t.quantity))},children:"➖"}),e.jsx("span",{className:"px-3 border rounded-sm border-black mx-1",children:t.quantity}),e.jsx("button",{onClick:()=>{t.quantity+=1,i(t.quantity)},children:"➕"})]}),e.jsx("td",{className:"text-right",children:t.price*t.quantity})]})]})}),e.jsx("div",{className:"flex w-[80px] items-center m-2 justify-center",children:e.jsx("button",{onClick:()=>{v(t.id)},className:"size-full flex items-center rounded-md justify-center ",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 hover:text-red-500 transition-all ease-in-out duration-150",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})})})})]})]},t.id))}),e.jsx("footer",{className:"py-5 px-3",children:e.jsxs("form",{action:"",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center gap-1",children:[e.jsxs("div",{className:"flex gap-1 w-full justify-center",children:[e.jsx("input",{type:"hidden",name:"meja",value:x}),e.jsx("input",{type:"hidden",name:"id",value:Math.floor(Math.random()*1e6)}),e.jsx("input",{type:"hidden",name:"items",value:JSON.stringify(s)}),e.jsx("input",{type:"hidden",name:"total",value:d})]}),e.jsxs("div",{className:"flex flex-col w-full  pt-0 gap-2  ",children:[e.jsx("label",{htmlFor:"dataDiri",children:"Data Diri"}),e.jsx("input",{onChange:t=>{o({...a,nama:t.target.value})},className:"h-8 rounded-md bg-neutral-100",placeholder:"Nama",name:"nama",type:"text"}),e.jsxs("div",{className:"grid grid-flow-col grid-cols-2 gap-2",children:[e.jsx("input",{onChange:t=>{o({...a,nohp:t.target.value})},className:"h-8 rounded-md bg-neutral-100",placeholder:"Phone",name:"nohp",type:"text"}),e.jsx("input",{onChange:t=>{o({...a,email:t.target.value})},className:"h-8 rounded-md bg-neutral-100",placeholder:"Email",name:"email",type:"text"})]})]})]}),e.jsxs("div",{className:"flex justify-between p-2",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:d.toLocaleString("id-ID",{style:"currency",currency:"IDR"})})]}),e.jsx("button",{className:!s.length||!a.nama||!a.nohp||!a.email?"bg-gray-300 text-white rounded-md p-2 w-full mb-12":"bg-blue-500 text-white rounded-md p-2 w-full mb-12",disabled:!s.length||!a.nama||!a.nohp||!a.email,onClick:async t=>{t.preventDefault();const l=document.querySelector("form"),w=new FormData(l),b=Object.fromEntries(w),c=await(await fetch("/api/checkout.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).json();if(c.success){const N=c.token;g(N)}else alert("Gagal melakukan checkout"),console.log(c)},children:"Checkout"})]})})]})]})};export{E as default};
